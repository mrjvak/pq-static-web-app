<!DOCTYPE html>
<html>
<body>
  <input type = "text" id="pq-prompt">
  <input type = "submit" id="btn">
  <iframe id="chat" style="width: 400px; height: 400px;" src=''> </iframe>
</body>
<script>
    var xhr = new XMLHttpRequest();          
    document.getElementById("btn").addEventListener("click", function () {
        var $pq-prompt = document.getElementById("pq-prompt").value;
        xhr.open('GET', "https://pq-chat-app.azurewebsites.net/api/hello?prompt=" + $pq-prompt, true);
        xhr.setRequestHeader('x-functions-key', 's6PGFRAoU9JuyjjRIldEPYpZFwZ22WS772OWUZ_DCbecAzFulQz9iQ==');
        xhr.send();
    
        //request = new XMLHttpRequest();
        //const reqUrl = "https://mudfoot.doc.stu.mmu.ac.uk/node/api/halloffame?year=" + $year
        //console.log("reqUrl: ", reqUrl);  
        //request.open("GET", reqUrl, true);
        //request.send(null);
    })
  
    xhr.onreadystatechange = processRequest;

    function processRequest(e) {
      //window.alert("sometext");
      if (xhr.readyState == 4  && xhr.status == 200) {
        //window.alert(xhr.responseText);
        //var response = JSON.parse(xhr.responseText);
        var response = xhr.responseText;      
        //document.getElementById("chat").src="https://webchat.botframework.com/embed/pq-bot?t="+response
        document.getElementById("chat").src= "data:text/html;charset=utf-8," + escape(response);
      }
    }

  </script>
</html>
